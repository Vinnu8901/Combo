//before head tag
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

//where div = Toolbar 
<input id="pageClassName" type="text"
  placeholder="Page class name (default: GeneratedPage)"
  style="margin:4px;padding:4px;width:220px">

<button id="btnExportZip">Export as ZIP</button>

//show toast

function getPageClassName(){
  const inp=document.querySelector('#pageClassName');
  let v=inp && inp.value.trim();
  if(!v) return 'GeneratedPage';
  v=v.replace(/[^A-Za-z0-9_]/g,'_');
  if(/^\d/.test(v)) v='_'+v;
  return v;
}

//replace btn zip all

async function exportZip(){
  const zip=new JSZip();
  const cls=getPageClassName();

  zip.file("pom.xml", generatePomSeleniumTestNG());
  zip.file("testng.xml", generateTestNGxml());
  zip.file("src/test/java/com/example/runner/CucumberTestNGRunner.java", generateRunnerTestNG());
  zip.file("src/test/java/com/example/hooks/Hooks.java", generateHooksSelenium());
  zip.file(`src/test/java/com/example/pages/${cls}.java`, generatePOMJavaSelenium(cls));
  zip.file(`src/test/java/com/example/steps/${cls}Steps.java`, generateStepsJavaSelenium(cls+"Steps"));
  zip.file("src/test/resources/features/generated.feature", generateFeatureTemplate());

  const blob=await zip.generateAsync({type:"blob"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url; a.download="project.zip"; a.click();
  setTimeout(()=>URL.revokeObjectURL(url),1000);
  showToast("ZIP Exported");
}

//add event listner
document.querySelector('#btnExportZip').addEventListener('click', exportZip);


<select id="mainMenu" style="margin:6px;padding:6px;width:260px;border-radius:8px;">
  <optgroup label="üîç Locator Panels">
    <option value="basic">Basic</option>
    <option value="wildcards">Wildcards</option>
    <option value="axes">Axes</option>
    <option value="functions">Functions & Relative</option>
    <option value="sf">Salesforce / LWC</option>
    <option value="pega">Pega</option>
  </optgroup>
  <optgroup label="‚öôÔ∏è POM & Steps Presets">
    <option value="sel_java_testng">Selenium + Java + Maven TestNG</option>
    <option value="sel_java_cucumber">Selenium + Java + Maven + Cucumber</option>
    <option value="pw_java_testng">Playwright + Java + Maven TestNG</option>
    <option value="pw_java_cucumber">Playwright + Java + Maven + Cucumber</option>
  </optgroup>
</select>


document.querySelector('#mainMenu').addEventListener('change', function(e){
  const val = e.target.value;

  // üîç Locator panels
  if(val === 'basic') switchPanel('basic');
  if(val === 'wildcards') switchPanel('wildcards');
  if(val === 'axes') switchPanel('axes');
  if(val === 'functions') switchPanel('functions');
  if(val === 'sf') switchPanel('sf');
  if(val === 'pega') switchPanel('pega');

  // ‚öôÔ∏è Preset selections
  if(val === 'sel_java_testng'){
    currentFramework = "selenium";
    currentLanguage  = "java";
    currentRunner    = "testng";
    fillLocatorList();
  }
  if(val === 'sel_java_cucumber'){
    currentFramework = "selenium";
    currentLanguage  = "java";
    currentRunner    = "cucumber";
    fillLocatorList();
  }
  if(val === 'pw_java_testng'){
    currentFramework = "playwright";
    currentLanguage  = "java";
    currentRunner    = "testng";
    fillLocatorList();
  }
  if(val === 'pw_java_cucumber'){
    currentFramework = "playwright";
    currentLanguage  = "java";
    currentRunner    = "cucumber";
    fillLocatorList();
  }
});
